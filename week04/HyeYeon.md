# 자바스크립트 완벽 가이드 3주차 학습 - 혜연

## 12장 이터레이터와 제너레이터

- 배열, 형식화 배열, 문자열, Set, Map과 같은 이터러블은 for/of 루프로 순회할 수 있음.
- 이터레이터는 스프레드 문법으로 분해할 수 있음.
- 이터레이터는 구조분해할당을 사용할 수 있음.
- keys(), values() 메서드로 키 또는 값만 순회할 수 있음.

### 12.1 이터레이터의 동작 방법

- 이터레이터 객체를 반환하는 특별한 이터레이터 메서드를 가진 객체는 모두 이터러블 객체
- 순회 결과 객체를 반환하는 next() 메서드가 ㅈ=있는 객체는 모두 이터레이터 객체
- 순회 결과 객체는 value와 done 프로퍼티가 있는 객체
- 이터러블 객체를 순회할 때, 이터레이터 메서드를 호출해 이터레이터 객체를 얻고, 이터레이터 객체의 next() 메서드를 반환값의 done 프로퍼티가 true일 때까지 반복적으로 호출함.

### 12.2 이터러블 객체 만들기

- 클래스를 이터러블로 만들기 위해서는 이름이 Symbol.iterator인 메서드를 만들어야 함.
- Symbol.iterator 메서드는 next() 메서드가 있는 이터레이터 객체를 반환해야 함.
- next() 메서드는 순회 결과 객체를 반환해야 하고, 순회 결과 객체에는 value 프로퍼티와 done 프로퍼티 중 하나는 반드시 존재해야 함.
- 이터러블 객체와 이터레이터는 lazy한 특징을 가짐.
  - 다음 값이 실제로 필요할 때까지 계산을 늦춤.

#### 12.2.1 이터레이터 '종료': return 메서드

- 이터레이터를 구조분해할당으로 사용하면 next() 메서드는 지정된 벼수 각각의 값을 얻을 수 있을 만큼만 호출됨.
- 이터레이터가 끝까지 실행되지 않더라도 파일을 닫을 수 있게 하기 위해 return() 메서드가 사용되기도 함.
- return() 메서드는 순회 결과 객체를 반환하고, 객체가 아닌 값을 반환하면 에러가 일어남.

### 12.3 제너레이터

- 이터레이터의 일종으로, 순회할 값이 데이터 구조의 요소가 아니라 계산 결과일 때 유용함.
- 제너레이터를 만들기 위해 function 키워드 다음 또는 메서드 이름 앞에 \*를 붙여 제너레이터 함수를 정의함.
  - 화살표 함수로 제너레이터 함수를 정의할 수는 없음.
- 제너레이터 함수를 호출하면 함수 바디를 실행하지 않고 이터레이터인 제너레이터 객체를 반환함.
- 제너레이터 객체의 next() 메서드를 호출하면 제너레이터 함수의 바디가 실행되며 yield 표현식을 만나면 멈춤.

#### 12.3.1 제너레이터 예제

- 제너레이터는 계산을 통해 전달할 값을 실제로 생성할 때 유용함.

#### 12.3.2 yield\*와 재귀 제너레이터

- yield\* 키워드는 이터러블 객체를 순회하면서 각각의 값을 전달함.
  - ```js
    const sequence = function* (...iterables) {
      for (let iterable of iterables) {
        yield* iterable;
      }
    };
    console.log([...sequence('abc', [1, 2, 3])]); // [ 'a', 'b', 'c', 1, 2, 3 ]
    ```
- yield\*를 써서 재귀 제너레이터를 만들 수 있고, 재귀적으로 정의된 트리 구조에 비재귀적 순회를 수행할 수 있음.
- yield와 yield\*는 제너레이터 함수 안에서만 사용할 수 있음.
  - 화살표함수에서는 허용되지 않음.

### 12.4 고급 제너레이터 기능

- 제너레이터는 계산을 잠시 멈추고 중간 값을 전달한 다음 계산을 재개할 수 있다는 특징이 있음.

#### 12.4.1 제너레이터 함수의 반환 값

- 값을 반환하는 제너레이터에서 next()를 마지막으로 호출했을 때 반환하는 객체에는 value와 done이 모두 존재함.
- next()를 명시적으로 호출하여 순회하도록 할 수 있음.

#### 12.4.2 yield 표현식의 값

- yield는 표현식이므로 값을 가질 수 있음.
- next()의 반환값은 yield 표현식을 평가한 값임.
- yield 표현식을 만나면 제너레이터 함수는 실행을 즉시 멈춤.
- next()를 첫 번째로 호출할 때 제너레이터가 시작되지만, 전달된 값은 제너레이터에서 접근할 수 없음.

#### 12.4.3 제너레이터의 return()과 throw() 메서드

- return()과 throw() 메서드를 호출하여 제너레이터의 실행 흐름을 제어할 수 있음.
- 제너레이터에서는 커스텀 return() 메서드를 만들 수는 없지만 try/finally 문을 통해 제너레이터가 종료될 때 정리 작업을 수행하게 할 수 있음.
- throw() 메서드를 호출하면 임의의 신호를 예외의 형태로 제너레이터에게 보내 항상 제너레이터에서 예외가 발생함.
- 제너레이터가 return()과 throw() 메서드가 정의된 이터러블 객체에 yield\*를 사용하면 return()이나 throw()를 호출할 때 이터레이터의 return()이나 throw() 메서드가 이어서 호출됨.

#### 12.4.4 제너레이터에 대한 마지막 노트

- 제너레이터는 강력하며 일반화된 제어문
- 제너레이터를 사용해서 싱글 스레드를 사용하는 자바스크립트 코드를 모아 일종의 스레드 협업 시스템을 만들 수 있음.
- 비동기를 제어하는 목적으로는 async와 await 키워드를 사용할 수 있으므로 제너레이터를 사용할 필요는 없음.
